addons:
  apt:
    packages:
    - realpath
language: python
services: docker
env:
  global:
  - MATRIX_BUILD=true
  - GITHUB_USER=joeblackwaslike
  - GITHUB_ORG=telephoneorg
  - DOCKER_USER=joeblackwaslike
  - DOCKER_ORG=telephoneorg
  # DOCKER_PASS
  - secure: "J1LDIv8okZVEfPVbXPqbKihEXvELGwwbTiCeEJ+eHBNgdZi2xckSnagqRYDfEZS9AnQXILF0eNhYdP8galurxr8viHcOq51rZPSxyV/hmGNMMnNkgoJhnf6cGxHrgYdSqXL6uwJG29NZlQe46Z9OZeEwYwB2wbLzcGVWAqMRkh19C6Gm0ArclEXNx2JwU93hIYNsNWZkCLwdL2d7kGCBymGth3ZqNwJLBZOZx/JtSiBs0N7IQaGEy6JmTE56xX+EBUQw/T0anPhhki82023ygDOv4OYailVcu49lskDEtB0TDwxTu2nEw7uEs4aD4+983E1pcrMFGmlPYUEyNzzkGl5PoFpA+BHHI/a0cuLv9Qj1KJC3OrVvJ+M1eKHR523+2mQY1MmQOwT8adf1mLf12zBzCEe4WxhPKjE/VSu2RcnfNpMI20R8ojh6oXIOZDN6I4A3y/jfQPQ420A6HjLWHinsr34SFAqKubyhdjyDybgLewNUtRKH/ioC88mat29c5j4E3287BmQ1KO0LMRGkO52uSIwnclW84VOQXYlNmYZq2mXOY8xGmIlgmYsDla3TCXMjWindApO7LPrNYidG5xdeDYkzyu3tC140rkn7EN/hycHXJBovabrZKdycCOYqquobJL865EP9NobiU+KT0sCPpS6U7fhX5v1NfMazu8w="
  # GITHUB_TOKEN
  - secure: "wq9d3IMRETRqRB82+AvOBR6U4qsvPfQOZDJo4QlD6D+e0PXr/AMQ7j3mIGx/Mk8DhGdNoZJAVdhR0iNZuUQ0wg+UIAazZLnQW7axCRL6w4g06N344T1lgpqiRFRACDmifPQ4V4ZlJ6nabq9wP7D4NllaTSbuWRwGVj03rAcbGFXMcVy0FGaOdj6tmP81io09k0zM0XZ9VzC1FIbSgbH1gDHN3v7Lazd++/qqpxWXO6dCjQSFJ1bVZOC7PDCXB6hl9u04mXJtGdNEy8RSwsHucotlrjZRq411/8m0JygLCSoIcbd0HQWIwDz1CcKXM+ViOXOrv6bYJDxzZapbgrXIH3kRPpzyUqcslB60srELFols8GbiDFHFJyoYI0kOD+tR4VSgufjRJXVCPQWphJKOuPNNMRzCzHa4tPeYLDZkHS2aDWitV2MuBRYyUCs/cEMUlT/1svor647zxxcaIEahMWP0LQFxK8PFgzYaczkoeMz+Jc+t4q7w9eXaoQLPKitPIv+hKYnxOY7KhFytXF565Wd63OVEqZu0JXfah4NfX4SE9pHo48LDIqqR3rdq3apg6IDTNd0gm2Qiju6TVj+u2MqI6/sp3BvauBRg8Rj570O58CydquJg3cWoYNDeMy2vUyYfc6HPNFrb2VPsJLIROlshoiERNQRz0RJQ71fEDFU="
  matrix:
  - RELEASE=debian/jessie
  - RELEASE=debian/stretch
notifications:
  email:
    on_success: never
    on_failure: always
  slack:
    rooms:
    - secure: "CC82M+lQc0p/7HPHXhRWHQX/BrdmVrbQs818YfNDugOYT6FrNx4VmuGVxN0DvHOCs4acsdqwWLT8Qt84LoSGPqNCGFA8NJQOdBpvtoKzRNV3fD3QA5binmDL67WVhEVvcgHr5s4mzq8icyoMNdv77MODzo8eNf3uFjMUYJlm9VIKjNXzkgtyoR8rqPOP4pRYEyjyC9cZuwmZnMeicKlKWv6CfgfT3Ws0sg32O8rJngQghjkYKbiex7rkkI0Jw2W8b+ZVo6wBSQDjaJXv6SzYcgLRNHgeXlc1NxqjRjy7qlQBm89dJxmV4gpZXvpB4HoiV0aA5if0xT3KtyaGyk32St/SzZDfEoXV8MFCmN9fUfnLYxeMfreM9macKXLI7ekiZNxigFmR0G0zDUj6XK9Fe5O+n8szLU1ZXfIiVbv1CHr05bQuuhgefHnNuVL9fNLu0TtaFd9F+jsAaOilALEq960FvvUYFcputTIu3d8T+NeWmUAt8Q68mnat2vWt2DJ9ZWoYnsWGsEEoc9WI9+MiZhQuwLhXqFuYGLI/jtmqBI7xV4jOVIi9ZZtz8F7/hQOb5dqmshai//mgMdgevKHUF16HBjdpwxe7NHBtfZijNim5FgkAaeDT7eo+O4jGNI0BTZUUYCXd/sgaTH7Z4vUMcHPn2t7T5KD7j9CPr2N9l50="
    on_success: always
    on_failure: always

before_install: source scripts/ci/environment.sh

install: make build

script: make test

after_success:
- ci-tag-build
- hub-push
- hub-update-readme
